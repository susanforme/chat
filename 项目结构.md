## 路由设计

<font color="red">**注意敏感操作必须用check鉴权**</font>

### home

| url  | method | query | body | response | 备注 |
| ---- | ------ | ----- | ---- | -------- | ---- |
| /    | get    |       |      |          |      |

### user

| url            | method | query      | body                               | response                                    |
| -------------- | ------ | ---------- | ---------------------------------- | ------------------------------------------- |
| /user/login    | post   |            | {userName:string, password:string} | {status:1,data:{userName:string,id:string}} |
| /user/logout   | get    |            |                                    | {status:1}                                  |
| /user/register | post   |            | {userName:string ,password:string} | {status:1,data:{userName:string,id:string}} |
| /user/captcha  | get    |            |                                    | {status:1,data:{img:string,text:string}}    |
| /user/profile  | get    | ?id=string |                                    | {status:1,data:{}}                          |
| /user/check    | get    |            |                                    |                                             |
| /user/balance  | get    | ?id=string |                                    |                                             |
| /user/balance  | post   |            | {id:string, updateBalance:number}  | {status:1}                                  |

| url            | method | 备注                                                         |
| -------------- | ------ | ------------------------------------------------------------ |
| /user/login    | post   | 登录 md5 加密                                                |
| /user/logout   | get    | 退出                                                         |
| /user/register | post   | 注册 md5 加密                                                |
| /user/captcha  | get    | 返回验证码                                                   |
| /user/profile  | get    | 根据id返回用户信息                                           |
| /user/check    | get    | (带上 cookie,判断权限)敏感操作必须检验,根据 cookie 来进行 id 获取 |
| /user/balance  | get    | 获得余额                                                     |
| /user/balance  | post   | 更改余额,如果是增加传正数,如果是购买行为传负数               |



### chat

| url           | method | query      | body               | response                                                     | 备注             |
| ------------- | ------ | ---------- | ------------------ | ------------------------------------------------------------ | ---------------- |
| /user/msglist | get    | ?id=string |                    | {status:1,data:string[]                                      | 返回数据为id集合 |
| /user/history | post   |            | {userIds:string[]} | {status:1,data:{send:{},receive:{},msg:string,createTime:string}[]} |                  |

### admin

| url             | method | query | body                      | response                      | 备注                      |
| --------------- | ------ | ----- | ------------------------- | ----------------------------- | ------------------------- |
| /admin/login    | post   |       | {userName,password}       | {status:1,data:{id,userName}} |                           |
| /admin/register | post   |       | {userName,password,token} | {status:1,data:{id,userName}} | 必须使用环境变量中的token |
|                 |        |       |                           |                               |                           |

### commodity

| url  | method | query | body | response | 备注 |
| ---- | ------ | ----- | ---- | -------- | ---- |
|      |        |       |      |          |      |
|      |        |       |      |          |      |
|      |        |       |      |          |      |



## socket 接口

| body                                                         | response                                    | 备注                                    |
| ------------------------------------------------------------ | ------------------------------------------- | --------------------------------------- |
| {send: {    id: string;    userName: string;  };  receive:  {    id: string;   userName: string;  };  msg: string;} | {status:1,data:{...body,createTime:string}} | emit('caht')发送信息,on('back')获得信息 |



## 备注

- status
  - 0 失败
  - 1 成功

## 备忘

1. 获取 ip 归属地 http://ip-api.com/json/?lang=zh-CN
2. 注意在关键路由使用 session 鉴权登录
3. 规定返回格式
4. 在服务器端对密码进行二次加密,加上一个加密字符串
